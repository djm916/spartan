; Streams Library

; Create a new stream
;
; Parameters:
;
; gen   A generator function that produces succesive stream values
; seed  The initial state value, passed to the generator

(defun stream/new (gen seed)
  (delay
    (let ((next-pair (gen seed)))
      (if (empty? next-pair)
        ()
        (list (car next-pair)
              (stream/new gen (cadr next-pair)))))))

; Return the next element of a stream

(defun stream/car (s) (car (force s)))

; Return the remainder of a stream

(defun stream/cdr (s) (cadr (force s)))

; Determine if a stream is empty

(defun stream/empty? (s) (empty? (force s)))
